INFO:backend.main:Windows detected - configuring asyncio event loop policy
INFO:backend.main:Set WindowsProactorEventLoopPolicy for asyncio
INFO:backend.tank_registry:TankRegistry initialized (no default tank)
INFO:backend.connection_manager:ConnectionManager initialized
INFO:backend.discovery_service:Loaded 1 server(s) from registry
INFO:backend.discovery_service:DiscoveryService initialized with 1 server(s)
INFO:__main__:============================================================
INFO:__main__:FISH TANK SIMULATION - WEB SERVER
INFO:__main__:============================================================
INFO:__main__:
INFO:__main__:Starting FastAPI backend server...
INFO:__main__:Open http://localhost:3000 in your browser
INFO:__main__:API docs available at http://localhost:8000/docs
INFO:__main__:
INFO:__main__:Press Ctrl+C to stop the server
INFO:__main__:============================================================
INFO:__main__:
INFO:     Started server process [29684]
INFO:     Waiting for application startup.
INFO:backend.main:============================================================
INFO:backend.main:LIFESPAN STARTUP: Beginning initialization
INFO:backend.main:Platform: Windows 11
INFO:backend.main:Python: 3.13.9 (tags/v3.13.9:8183fa5, Oct 14 2025, 14:09:13) [MSC v.1944 64 bit (AMD64)]
INFO:backend.main:============================================================
INFO:backend.main:Checking for saved tank snapshots...
INFO:backend.tank_persistence:Found 3 tanks with saved snapshots
INFO:backend.main:Found 3 tank(s) with saved snapshots
INFO:backend.main:Restoring tank a043b20e from data\tanks\a043b20e-7391-4f8c-8854-1b23146b444f\snapshots\snapshot_20251125_210724.json
INFO:backend.tank_persistence:Loaded snapshot for tank a043b20e from snapshot_20251125_210724.json (18 entities)
INFO:core.simulation_engine:Created 3 initial fractal plants
INFO:backend.simulation_runner:Migration context updated for tank None: conn_mgr=NULL, registry=NULL
INFO:backend.simulation_manager:SimulationManager initialized: tank_id=ec63a6c3-0374-40e2-af91-03ba9f9a8de8, name=Tank 1, persistent=True
INFO:backend.tank_persistence:Restored tank a043b20e to frame 0 (18 entities)
INFO:backend.tank_registry:Restored tank a043b20e from snapshot (frame: 0, entities: 18)
INFO:backend.main:Successfully restored tank a043b20e
INFO:backend.main:Restoring tank c6c18b10 from data\tanks\c6c18b10-f1bf-4fde-8e59-fe78ef0c9ff7\snapshots\snapshot_20251125_210724.json
INFO:backend.tank_persistence:Loaded snapshot for tank c6c18b10 from snapshot_20251125_210724.json (21 entities)
INFO:core.simulation_engine:Created 3 initial fractal plants
INFO:backend.simulation_runner:Migration context updated for tank None: conn_mgr=NULL, registry=NULL
INFO:backend.simulation_manager:SimulationManager initialized: tank_id=108b49d6-7084-485e-b1f2-bea5e251a5ce, name=Tank 1, persistent=True
INFO:backend.tank_persistence:Restored tank c6c18b10 to frame 11 (21 entities)
INFO:backend.tank_registry:Restored tank c6c18b10 from snapshot (frame: 11, entities: 21)
INFO:backend.main:Successfully restored tank c6c18b10
INFO:backend.main:Restoring tank f2a00893 from data\tanks\f2a00893-c7d9-4a4f-861d-3c207d014521\snapshots\snapshot_20251125_210725.json
INFO:backend.tank_persistence:Loaded snapshot for tank f2a00893 from snapshot_20251125_210725.json (19 entities)
INFO:core.simulation_engine:Created 3 initial fractal plants
INFO:backend.simulation_runner:Migration context updated for tank None: conn_mgr=NULL, registry=NULL
INFO:backend.simulation_manager:SimulationManager initialized: tank_id=d831aa2e-b0d3-4e18-9a10-65fa692b0351, name=Tank 1, persistent=True
INFO:backend.tank_persistence:Restored tank f2a00893 to frame 30 (19 entities)
INFO:backend.tank_registry:Restored tank f2a00893 from snapshot (frame: 30, entities: 19)
INFO:backend.main:Successfully restored tank f2a00893
INFO:backend.main:Tank registry has 3 tank(s)
INFO:backend.main:Default tank set: a043b20e
INFO:backend.main:Starting all tank simulations...
INFO:backend.simulation_runner:Migration context updated for tank a043b20e: conn_mgr=SET, registry=SET
INFO:backend.simulation_manager:Starting simulation for tank a043b20e-7391-4f8c-8854-1b23146b444f
INFO:backend.simulation_runner:Simulation loop: Starting
INFO:backend.main:Tank a043b20e started
INFO:backend.simulation_runner:Migration context updated for tank c6c18b10: conn_mgr=SET, registry=SET
INFO:backend.simulation_manager:Starting simulation for tank c6c18b10-f1bf-4fde-8e59-fe78ef0c9ff7
INFO:backend.simulation_runner:Simulation loop: Starting
INFO:backend.main:Tank c6c18b10 started
INFO:backend.simulation_runner:Migration context updated for tank f2a00893: conn_mgr=SET, registry=SET
INFO:backend.simulation_manager:Starting simulation for tank f2a00893-c7d9-4a4f-861d-3c207d014521
INFO:backend.simulation_runner:Simulation loop: Starting
INFO:backend.main:Tank f2a00893 started
INFO:backend.main:Starting broadcast tasks...
INFO:backend.main:Broadcast task started for tank a043b20e
INFO:backend.main:Broadcast task started for tank c6c18b10
INFO:backend.main:Broadcast task started for tank f2a00893
INFO:backend.main:Starting discovery service...
INFO:backend.discovery_service:DiscoveryService cleanup loop started
INFO:backend.main:Discovery service started
INFO:backend.discovery_service:Server registered: local-server at 10.26.128.66:8000 (Aztek)
INFO:backend.main:Local server registered: local-server
INFO:backend.main:Heartbeat task started
INFO:backend.main:Starting server client...
INFO:backend.main:Server client started
INFO:backend.main:Configuring TankRegistry for distributed operations...
INFO:backend.tank_registry:TankRegistry distributed services configured
INFO:backend.main:TankRegistry configured for distributed operations
INFO:backend.main:Starting migration scheduler...
INFO:backend.migration_scheduler:MigrationScheduler initialized (check_interval=10.0s)
INFO:backend.migration_scheduler:Migration scheduler started
INFO:backend.main:Migration scheduler started
INFO:backend.main:Starting auto-save service...
INFO:backend.auto_save_service:Auto-save service started
INFO:backend.auto_save_service:Started auto-save for tank a043b20e (interval: 300.0s)
INFO:backend.auto_save_service:Started auto-save for tank c6c18b10 (interval: 300.0s)
INFO:backend.auto_save_service:Started auto-save for tank f2a00893 (interval: 300.0s)
INFO:backend.main:Auto-save service started
INFO:backend.main:LIFESPAN STARTUP: Complete - yielding control to app
INFO:backend.main:broadcast_updates[a043b20e]: Task started
INFO:backend.main:broadcast_updates[a043b20e]: Simulation unpaused
INFO:backend.main:broadcast_updates[c6c18b10]: Task started
INFO:backend.main:broadcast_updates[c6c18b10]: Simulation unpaused
INFO:backend.main:broadcast_updates[f2a00893]: Task started
INFO:backend.main:broadcast_updates[f2a00893]: Simulation unpaused
INFO:backend.migration_scheduler:Migration scheduler loop started
INFO:     Application startup complete.
ERROR:    [Errno 10048] error while attempting to bind on address ('0.0.0.0', 8000): [winerror 10048] only one usage of each socket address (protocol/network address/port) is normally permitted
INFO:     Waiting for application shutdown.
INFO:backend.main:LIFESPAN SHUTDOWN: Received shutdown signal
INFO:backend.main:LIFESPAN SHUTDOWN: Cleaning up resources...
INFO:backend.main:Saving all persistent tanks...
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
INFO:backend.tank_persistence:Saved tank a043b20e state to snapshot_20251125_210828.json (18 entities)
INFO:backend.auto_save_service:Manual save completed for tank a043b20e
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
INFO:backend.tank_persistence:Saved tank c6c18b10 state to snapshot_20251125_210829.json (22 entities)
INFO:backend.auto_save_service:Manual save completed for tank c6c18b10
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
WARNING:backend.entity_transfer:Cannot transfer entity of type Food
INFO:backend.tank_persistence:Saved tank f2a00893 state to snapshot_20251125_210829.json (22 entities)
INFO:backend.auto_save_service:Manual save completed for tank f2a00893
INFO:backend.simulation_runner:Auto-eval reward: Fish #21 gained 65.8 energy
INFO:backend.auto_save_service:Saved 3 persistent tanks
INFO:backend.main:Saved 3 persistent tank(s) before shutdown
INFO:backend.main:Stopping auto-save service...
INFO:backend.auto_save_service:Stopping auto-save service...
INFO:backend.auto_save_service:Auto-save loop cancelled for tank a043b20e
INFO:backend.auto_save_service:Auto-save task cancelled for tank a043b20e
INFO:backend.auto_save_service:Auto-save loop cancelled for tank c6c18b10
INFO:backend.auto_save_service:Auto-save task cancelled for tank c6c18b10
INFO:backend.auto_save_service:Auto-save loop cancelled for tank f2a00893
INFO:backend.auto_save_service:Auto-save task cancelled for tank f2a00893
INFO:backend.auto_save_service:Auto-save service stopped
INFO:backend.main:Auto-save service stopped
INFO:backend.main:Stopping broadcast tasks...
INFO:backend.main:broadcast_updates[a043b20e]: Task cancelled during sleep
INFO:backend.main:broadcast_updates[a043b20e]: Task cancelled (outer handler)
INFO:backend.main:broadcast_updates[a043b20e]: Task ended
INFO:backend.main:Broadcast task stopped for tank a043b20e
INFO:backend.main:broadcast_updates[c6c18b10]: Task cancelled during sleep
INFO:backend.main:broadcast_updates[c6c18b10]: Task cancelled (outer handler)
INFO:backend.main:broadcast_updates[c6c18b10]: Task ended
INFO:backend.main:Broadcast task stopped for tank c6c18b10
INFO:backend.main:broadcast_updates[f2a00893]: Task cancelled during sleep
INFO:backend.main:broadcast_updates[f2a00893]: Task cancelled (outer handler)
INFO:backend.main:broadcast_updates[f2a00893]: Task ended
INFO:backend.main:Broadcast task stopped for tank f2a00893
INFO:backend.main:Stopping migration scheduler...
INFO:backend.migration_scheduler:Migration scheduler loop cancelled
INFO:backend.migration_scheduler:Migration scheduler loop ended after 1 checks
INFO:backend.migration_scheduler:Migration scheduler stopped
INFO:backend.main:Migration scheduler stopped
INFO:backend.main:Stopping all simulations...
INFO:backend.simulation_manager:Stopping simulation for tank a043b20e-7391-4f8c-8854-1b23146b444f
INFO:backend.simulation_runner:Simulation loop: Ended after 53 frames
INFO:backend.simulation_manager:Stopping simulation for tank c6c18b10-f1bf-4fde-8e59-fe78ef0c9ff7
INFO:backend.simulation_runner:Simulation loop: Ended after 60 frames
INFO:backend.simulation_manager:Stopping simulation for tank f2a00893-c7d9-4a4f-861d-3c207d014521
INFO:backend.simulation_runner:Simulation loop: Ended after 60 frames
INFO:backend.main:All simulations stopped!
INFO:backend.main:Stopping heartbeat task...
INFO:backend.main:Heartbeat loop cancelled
INFO:backend.main:Heartbeat task stopped
INFO:backend.main:Stopping discovery service...
INFO:backend.discovery_service:DiscoveryService cleanup loop stopped
INFO:backend.main:Discovery service stopped
INFO:backend.main:Stopping server client...
INFO:backend.main:Server client stopped
INFO:backend.main:LIFESPAN SHUTDOWN: Complete
INFO:backend.main:============================================================
INFO:     Application shutdown complete.
